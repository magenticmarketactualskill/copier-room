@startuml Copier-Room Hexagonal Architecture

!define CORE_COLOR #E8F5E9
!define PORT_COLOR #BBDEFB
!define ADAPTER_COLOR #FFF9C4
!define EXTERNAL_COLOR #FFCCBC

skinparam component {
    BackgroundColor<<core>> CORE_COLOR
    BorderColor<<core>> #4CAF50
    BackgroundColor<<port>> PORT_COLOR
    BorderColor<<port>> #2196F3
    BackgroundColor<<adapter>> ADAPTER_COLOR
    BorderColor<<adapter>> #FFC107
    BackgroundColor<<external>> EXTERNAL_COLOR
    BorderColor<<external>> #FF5722
}

skinparam interface {
    BackgroundColor PORT_COLOR
    BorderColor #2196F3
}

package "Copier-Room Core (Hexagon)" <<core>> {
    component [Function Chain\nProcessor] as FunctionChain <<core>>
    component [Git Integration\nEngine] as GitEngine <<core>>
    component [Content\nComposition] as ContentComposer <<core>>
    component [Template\nResolver] as TemplateResolver <<core>>
    
    FunctionChain --> ContentComposer
    ContentComposer --> TemplateResolver
    FunctionChain --> GitEngine
}

package "Ports (Interfaces)" <<port>> {
    interface "JSON-RPC-LD\nAPI Port" as JSONRPCLD
    interface "Content\nGeneration Port" as ContentPort
    interface "Version Control\nPort" as VCPort
}

package "Framework Adapters" <<adapter>> {
    component [Rails Client\nAdapter] as RailsAdapter <<adapter>>
    component [Django Client\nAdapter] as DjangoAdapter <<adapter>>
    component [Laravel Client\nAdapter] as LaravelAdapter <<adapter>>
}

package "External Systems" <<external>> {
    component [Ruby on Rails\nApplication] as RailsApp <<external>>
    component [Django\nApplication] as DjangoApp <<external>>
    component [Laravel\nApplication] as LaravelApp <<external>>
    component [AI Authoring\nSystem] as AISystem <<external>>
    component [Human Editor\nInterface] as HumanEditor <<external>>
}

package "Ontological Storage" <<core>> {
    database "Functional\nRepository" as FunctionalRepo {
        folder "ui.hier" as UIHier
        folder "ui.data" as UIData
        folder "data.component" as DataComponent
    }
    
    database "Contextual\nRepository" as ContextualRepo {
        folder "platform" as Platform
        folder "language" as Language
        folder "framework" as Framework
    }
    
    database "Compositional\nRepository" as CompositionalRepo {
        folder "platform/role" as PlatformRole
    }
}

' Port connections to Core
FunctionChain -up-> JSONRPCLD : implements
ContentComposer -up-> ContentPort : implements
GitEngine -up-> VCPort : implements

' Adapter connections to Ports
RailsAdapter --> JSONRPCLD : uses
DjangoAdapter --> JSONRPCLD : uses
LaravelAdapter --> JSONRPCLD : uses

' External system connections to Adapters
RailsApp --> RailsAdapter : integrates
DjangoApp --> DjangoAdapter : integrates
LaravelApp --> LaravelAdapter : integrates

' AI and Human connections
AISystem --> JSONRPCLD : uses
HumanEditor --> JSONRPCLD : uses

' Core connections to Storage
TemplateResolver --> FunctionalRepo : reads
TemplateResolver --> ContextualRepo : reads
TemplateResolver --> CompositionalRepo : reads
GitEngine --> FunctionalRepo : manages
GitEngine --> ContextualRepo : manages
GitEngine --> CompositionalRepo : manages

note right of JSONRPCLD
  **JSON-RPC-LD Protocol**
  - Semantic communication
  - Framework-agnostic
  - Self-describing data
  - SHACL validation
end note

note bottom of FunctionalRepo
  **Ontological Organization**
  All styling, components, and
  functionality organized by
  purpose, not by project
end note

note left of RailsAdapter
  **Framework Clients**
  Translate framework-specific
  requests to JSON-RPC-LD
  and integrate responses
  in-stream with workflows
end note

@enduml
